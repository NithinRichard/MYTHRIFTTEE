<script src="https://unpkg.com/@studio-freight/lenis@1.0.29/dist/lenis.min.js"></script>

<style>
  html.lenis {
    height: auto;
  }

  .lenis.lenis-smooth {
    scroll-behavior: auto;
  }

  .lenis.lenis-smooth [data-lenis-prevent] {
    overscroll-behavior: contain;
  }

  .lenis.lenis-stopped {
    overflow: hidden;
  }

  .lenis.lenis-scrolling iframe {
    pointer-events: none;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const lenis = new Lenis({
      duration: 2.0, // Increased for weightier feel
      easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
      direction: 'vertical',
      gestureDirection: 'vertical',
      smooth: true,
      mouseMultiplier: 0.8, // Reduced for weightier feel
      smoothTouch: false,
      touchMultiplier: 2,
    });

    function raf(time) {
      lenis.raf(time);
      requestAnimationFrame(raf);
    }

    requestAnimationFrame(raf);

    // Parallax Effect
    lenis.on('scroll', () => {
      const parallaxElements = document.querySelectorAll('[data-parallax]');
      parallaxElements.forEach(el => {
        const speed = parseFloat(el.dataset.speed) || 0.5;
        const rect = el.getBoundingClientRect();
        const parentRect = el.parentElement.getBoundingClientRect();
        
        // Only animate if in view (with some buffer)
        if (parentRect.top < window.innerHeight && parentRect.bottom > 0) {
           // Calculate position relative to viewport center or top
           // Using -parentRect.top * speed means:
           // When section is at top of screen, transform is 0.
           // When section moves up (scrolled down), parentRect.top becomes negative.
           // -(-100) * 0.5 = 50. Element moves DOWN relative to parent.
           // This creates the parallax effect (background moves slower than foreground).
           const y = -parentRect.top * speed;
           el.style.transform = `translateY(${y}px)`;
        }
      });
    });

    window.lenis = lenis;
  });
</script>
